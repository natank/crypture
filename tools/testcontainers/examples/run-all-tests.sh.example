#!/bin/bash
# Run all tests (unit + integration + container) with Testcontainers environment
# Copy this file to your service's tests/integration/ directory and customize

export TESTCONTAINERS_DOCKER_SOCKET_OVERRIDE=/var/run/docker.sock
export TESTCONTAINERS_RYUK_DISABLED=true

echo "üß™ Running all tests with Podman..."
echo "Environment:"
echo "  TESTCONTAINERS_DOCKER_SOCKET_OVERRIDE=$TESTCONTAINERS_DOCKER_SOCKET_OVERRIDE"
echo "  TESTCONTAINERS_RYUK_DISABLED=$TESTCONTAINERS_RYUK_DISABLED"
echo ""

echo "üì¶ Running unit tests..."
npm run test:unit
echo ""

echo "üîó Running integration tests..."
npm run test:integration
echo ""

echo "üê≥ Running container tests..."
npx jest --config jest.config.containers.js --testPathPattern=tests/containers
